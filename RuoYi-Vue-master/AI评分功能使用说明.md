# AI评分功能使用说明

## 功能概述

本功能基于火山方舟大模型，实现了对作业的自动AI评分。系统能够从作业文件和学生提交的文件中提取文字内容，然后调用AI模型进行智能评分。

## 环境要求

1. **Java版本**: 1.8或以上
2. **火山方舟API密钥**: 需要从火山方舟平台获取API密钥
3. **网络连接**: 需要能够访问火山方舟API服务

## 安装步骤

### 1. 检查Java版本
```bash
java -version
```
确保Java版本为1.8或以上。

### 2. 配置API密钥
在系统环境变量中设置火山方舟API密钥：
```bash
# Windows
set ARK_API_KEY=your_api_key_here

# Linux/Mac
export ARK_API_KEY=your_api_key_here
```

或者在`application.yml`中直接配置：
```yaml
ark:
  api:
    key: your_api_key_here
```

### 3. 安装依赖
项目已经配置了必要的依赖，包括：
- `volcengine-java-sdk-ark-runtime`: 火山方舟SDK
- `tika-core`和`tika-parsers-standard-package`: 文档文字提取

运行以下命令安装依赖：
```bash
mvn clean install
```

## 功能特性

### 1. 文档文字提取
- 支持从PDF、DOC、DOCX、TXT等格式文件中提取文字
- 自动处理文件路径和编码问题
- 文件大小限制为10MB

### 2. AI智能评分
- 基于作业内容和学生提交内容进行评分
- 评分范围：0-100分
- 自动生成评语，指出错误和知识点遗漏
- 支持JSON格式的标准化响应

### 3. 用户界面
- 在作业评分详情页面添加"AI评分"按钮
- 实时显示评分进度
- 自动填充评分结果和评语

## 使用方法

### 1. 教师端使用
1. 登录系统，进入课程管理
2. 选择"作业"标签页
3. 在"作业评分"区域，点击"查看详情"
4. 在评分对话框中，点击"AI评分"按钮
5. 等待AI评分完成，系统会自动填充分数和评语
6. 可以手动调整评分结果，然后点击"保存"

### 2. 评分逻辑
AI模型会根据以下信息进行评分：
- 课程名称和作业名称
- 作业描述和附件内容
- 学生提交的文字内容和文件
- 作业的截止时间等上下文信息

## 配置说明

### 1. 模型配置
在`application.yml`中可以配置：
```yaml
ark:
  model:
    id: doubao-1-5-pro-256k-250115  # 模型ID
  base:
    url: https://ark.cn-beijing.volces.com/api/v3  # API地址
```

### 2. 文件路径配置
确保文件上传路径配置正确：
```yaml
ruoyi:
  profile: C:\SoftwareSystemDevelopment\ruoyi\uploadPath
```

## 注意事项

1. **API密钥安全**: 请妥善保管API密钥，不要提交到代码仓库
2. **文件大小**: 单个文件大小限制为10MB，超过限制的文件会被跳过
3. **网络连接**: 确保服务器能够访问火山方舟API服务
4. **评分准确性**: AI评分仅供参考，建议教师进行最终审核
5. **费用控制**: 注意API调用次数，避免产生过多费用

## 故障排除

### 1. API调用失败
- 检查API密钥是否正确
- 确认网络连接正常
- 查看日志中的详细错误信息

### 2. 文件提取失败
- 检查文件格式是否支持
- 确认文件路径是否正确
- 查看文件大小是否超过限制

### 3. 评分结果异常
- 检查作业和学生提交内容是否完整
- 确认AI模型响应格式是否正确
- 查看日志中的评分过程

## 技术支持

如遇到问题，请检查：
1. 系统日志文件
2. 网络连接状态
3. API密钥有效性
4. 文件上传路径配置

## 更新日志

- v1.0.0: 初始版本，支持基本的AI评分功能
- 支持多种文档格式的文字提取
- 集成火山方舟大模型API
- 提供友好的用户界面 